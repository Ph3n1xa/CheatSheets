## üéØ SYNTAXE DE BASE
```Bash
nmap [scan_type] [options] [target]
```
## ‚ö° HOST DISCOVERY (Qui est vivant ?)
```Bash
# Scan r√©seau complet (ping sweep)
nmap -sn 192.168.1.0/24
# Liste d'IPs depuis fichier
nmap -sn -iL targets.txt
# Plage d'IPs sp√©cifique
nmap -sn 192.168.1.1-50
# Forcer ICMP (√©viter ARP)
nmap -sn -PE --disable-arp-ping <target>
# Host discovery avec debug
nmap -sn --reason --packet-trace <target>
```
## üîç PORT SCANNING (Quels services ?)
### **Types de Scans TCP**
```Bash
# SYN Scan (par d√©faut, rapide, discret)
nmap -sS <target>
# Connect Scan (pas besoin root)
nmap -sT <target>
# ACK Scan (d√©tection firewall)
nmap -sA <target>
# FIN Scan (√©viter d√©tection)
nmap -sF <target>
# NULL Scan (furtif)
nmap -sN <target>
# Xmas Scan (flags FIN+PSH+URG)
nmap -sX <target>
```
### **Scans UDP & Autres**
```Bash
# UDP Scan (lent mais crucial)
nmap -sU <target>
# TCP + UDP combin√©
nmap -sS -sU <target>
# Protocoles IP
nmap -sO <target>
```
### **Sp√©cification de Ports**
```Bash
# Port sp√©cifique
nmap -p 80 <target>
# Ports multiples
nmap -p 22,80,443 <target>
# Plage de ports
nmap -p 1-1000 <target>
# Tous les ports TCP (0-65535)
nmap -p- <target>
# Top 100 ports les plus communs
nmap --top-ports 100 <target>
# Top 1000 ports (par d√©faut)
nmap --top-ports 1000 <target>
```
## üïµÔ∏è SERVICE DETECTION & OS FINGERPRINTING
```Bash
# D√©tection version services
nmap -sV <target>
# D√©tection OS
nmap -O <target>
# Scripts par d√©faut + version
nmap -sC -sV <target>
# Scan agressif (tout en un)
nmap -A <target>
# Version d√©tection intensive
nmap --version-intensity 9 <target>
```
## üîß NMAP SCRIPTING ENGINE (NSE)
### **Cat√©gories de Scripts**
```Bash
# Scripts par d√©faut
nmap --script default <target>
# Scripts de vuln√©rabilit√©s
nmap --script vuln <target>
# Scripts de bruteforce
nmap --script brute <target>
# Scripts de d√©couverte
nmap --script discovery <target>
# Scripts malware d√©tection
nmap --script malware <target>
# Scripts authentification
nmap --script auth <target>
```
### **Scripts Sp√©cifiques**
```Bash
# Web enumeration
nmap --script http-enum <target>
# SMB vuln√©rabilit√©s
nmap --script smb-vuln-* <target>
# SSL/TLS analysis
nmap --script ssl-cert,ssl-enum-ciphers <target>
# DNS enumeration
nmap --script dns-zone-transfer <target>
# SSH info
nmap --script ssh2-enum-algos <target>
```
## ü•∑ FIREWALL/IDS EVASION
### **Techniques de Furtivit√©**
```Bash
# Fragmentation paquets
nmap -f <target>
# Fragmentation custom (8 bytes)
nmap -f -f <target>
nmap --mtu 16 <target>
# Decoy scans (IP leurres)
nmap -D RND:10 <target>
nmap -D decoy1,decoy2,ME <target>
# Spoof source IP
nmap -S <fake_ip> <target>
# Source port sp√©cifique
nmap -g 53 <target>
nmap --source-port 53 <target>
```
### **Timing Templates**
```Bash
# T0: Paranoid (tr√®s lent, furtif)
nmap -T0 <target>
# T1: Sneaky (lent, √©viter IDS)
nmap -T1 <target>
# T2: Polite (lent, peu de bande passante)
nmap -T2 <target>
# T3: Normal (par d√©faut)
nmap -T3 <target>
# T4: Aggressive (rapide, fiable)
nmap -T4 <target>
# T5: Insane (tr√®s rapide, peut louper)
nmap -T5 <target>
```
### **Contr√¥le Timing Avanc√©**
```Bash
# Rate minimum/maximum
nmap --min-rate 1000 <target>
nmap --max-rate 100 <target>
# D√©lais entre paquets
nmap --scan-delay 1s <target>
nmap --max-scan-delay 10s <target>
# Timeout personnalis√©
nmap --host-timeout 900s <target>
```
## üíæ OUTPUT & REPORTING
### **Formats de Sortie**
```Bash
# Normal output
nmap -oN scan.txt <target>
# XML output (parseable)
nmap -oX scan.xml <target>
# Grepable output
nmap -oG scan.gnmap <target>
# Tous les formats
nmap -oA complete_scan <target>
# Script kiddie format
nmap -oS scan.skid <target>
```
### **Verbosit√© & Debug**
```Bash
# Verbose (progression temps r√©el)
nmap -v <target>
# Double verbose
nmap -vv <target>
# Debug l√©ger
nmap -d <target>
# Debug intensif
nmap -dd <target>
# Voir raisons des r√©sultats
nmap --reason <target>
# Trace paquets envoy√©s/re√ßus
nmap --packet-trace <target>
```
## üöÄ COMBINAISONS PENTESTING COURANTES
### **Reconnaissance Initiale**
```Bash
# Phase 1: Host Discovery
nmap -sn 192.168.1.0/24 -oA discovery
# Phase 2: Port Scan rapide
nmap -sS --top-ports 1000 -oA portscan <targets>
# Phase 3: Service enumeration
nmap -sS -sV -sC -p <open_ports> -oA services <targets>
```
### **Scan Complet Stealth√©**
```Bash
# Maximum d'infos, minimum de bruit
nmap -sS -sV -sC -O -A -T2 -f --randomize-hosts -oA stealth_complete <target>
```
### **Scan Ultra-Rapide**
```Bash
# Speed pentesting (CTF/labs)
nmap -sS -T4 --min-rate 1000 --max-retries 2 -p- <target>
```
### **Scan Anti-Firewall**
```Bash
# Contourner restrictions
nmap -sS -f -D RND:10 -g 53 --randomize-hosts -T2 <target>
```
### **Vuln√©rability Assessment**
```Bash
# Detection vulns automatique
nmap -sS -sV --script vuln -oA vuln_scan <target>
```
### **Web Application Focus**
```Bash
# Sp√©cialisation web apps
nmap -sS -sV -p 80,443,8080,8443 --script http-* <target>
```
### **Active Directory Recon**
```Bash
# Environnement Windows/AD
nmap -sS -sV -p 53,88,135,139,389,445,636,3268,3269 --script smb-*,ldap-* <target>
```
## üõ°Ô∏è SITUATIONS SP√âCIFIQUES
### **R√©seau Lent/Fragile**
```Bash
nmap -sS -T1 --scan-delay 2s --max-scan-delay 10s <target>
```
### **Firewall Tr√®s Restrictif**
```Bash
nmap -sA -T1 -f -D RND:5 -g 53 --data-length 25 <target>
```
### **Scan de Production**
```Bash
nmap -sS -T2 --top-ports 100 --max-retries 1 <target>
```
### **Labs/CTF Rapide**
```Bash
nmap -sS -T4 -A --min-rate 5000 --max-retries 1 -p- <target>
```
### **IPv6 Networks**
```Bash
nmap -6 -sS -sV <ipv6_target>
```
### **Scanning Through Proxies**
```Bash
nmap --proxies socks4://proxy:1080 <target>
```
## üí° TIPS PRODUCTIVIT√â
### **Extraction R√©sultats**
```Bash
# IPs vivantes depuis discovery
grep "Nmap scan report" discovery.nmap | cut -d" " -f5
# Ports ouverts uniquement
grep "open" portscan.nmap
# Services avec versions
grep -E "(open|version)" services.nmap
```
### **Automation Bash**
```Bash
# Scan multiple targets
for ip in $(cat targets.txt); do
    nmap -sS -sV $ip -oA scan_$ip
done
# Pipeline discovery ‚Üí portscan
nmap -sn 192.168.1.0/24 | grep "Nmap scan report" | cut -d" " -f5 | xargs -I {} nmap -sS {}
```
### **Performance Monitoring**
```Bash
# Surveiller progression scan long
nmap -v -sS -p- <target> | grep "completed"
# Stats temps r√©el
nmap -vv --stats-every 30s <target>
```
## ‚ö†Ô∏è COMMANDES √Ä √âVITER EN PRODUCTION
```Bash
# DANGER: Peut planter services
nmap -sU --max-rate 10000 <production_server>
# DANGER: Tr√®s bruyant, alertes IDS
nmap -T5 -A --script vuln <target>
# DANGER: Peut g√©n√©rer beaucoup de logs
nmap -p- -T4 --min-rate 5000 <target>
```
